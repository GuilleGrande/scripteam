# Story 2.1: React Web Complete PoC - End-to-End ScripTeam Experience

## Status
Phase B Complete - Script Upload Working End-to-End

> **UPDATE 2025-09-26 PM**: Major milestone! Complete script upload workflow functional. Users can upload scripts via web UI, files are processed by API backend, stored in PostgreSQL, and UI transitions smoothly through processing phases. Full-stack integration working perfectly.

> **TECHNICAL DEBT RESOLVED**: Fixed database connectivity, CORS configuration, file upload event handling, and React component state management. Hot reloading issues resolved via container restarts.

## Story
**As a** drama student,
**I want** a complete web-based ScripTeam experience that takes me from script upload through AI-powered scene practice,
**so that** I can validate the full value proposition of practicing with AI scene partners.

## Acceptance Criteria

### 1. Script Upload & Analysis
- User can upload PDF/TXT script files through intuitive web interface
- System extracts and displays script content with 95%+ accuracy
- AI analyzes script and identifies characters, scenes, and dialogue structure
- User can review and confirm extracted characters and scenes

### 2. Character & Scene Management
- System automatically detects main characters from script analysis
- User can select which character they want to play
- System presents available scenes featuring the user's chosen character
- Clear scene selection interface with character participation indicators

### 3. AI Voice Generation
- System generates unique AI voices for each non-user character
- Voice synthesis uses ElevenLabs API with Spanish/English support
- Each character gets consistent voice personality throughout scenes
- Voice quality suitable for practice sessions (clear, natural-sounding)

### 4. Scene Preparation & Setup
- User selects specific scene to practice
- System displays scene context and character motivations
- User can review their lines and other characters' lines
- Practice session setup with difficulty/pacing options

### 5. Interactive Scene Practice
- Real-time conversation flow with AI characters speaking their lines
- User speaks/types their character's lines at appropriate moments
- System manages turn-taking and scene progression
- Audio playback of AI character voices integrated seamlessly

### 6. Session Management
- User can pause, resume, restart scenes at any time
- Progress tracking through scene completion
- Basic session history and practice statistics
- Option to practice same scene multiple times

## Tasks / Subtasks

### Phase A: Foundation Setup (Day 1) âœ… COMPLETED
- [x] ~~Create React app with Vite + TypeScript~~ âœ… Done (Lovable PoC integrated)
- [x] ~~Set up project structure and development environment~~ âœ… Done (Docker setup complete)
- [x] ~~Install and configure ShadCN/UI components~~ âœ… Done (Full component library available)
- [x] ~~Set up Tailwind CSS and basic styling system~~ âœ… Done (Modern design system ready)
- [x] ~~Configure API client for backend integration~~ âœ… Done (API client at /lib/api.ts)

### Phase B: Script Upload & Analysis (Day 1-2) âœ… COMPLETED
- [x] ~~**Create ScriptUpload component** (reuse existing logic)~~ âœ… COMPLETED
  - [x] ~~File drag-and-drop interface with validation~~ âœ… Done (PDF/TXT support)
  - [x] ~~Upload progress indicator and error handling~~ âœ… Done (AI processing phases with toast notifications)
  - [x] ~~Integration with existing `/scripts` API endpoint~~ âœ… Done (Full stack working)
  - [x] ~~Database connectivity and transaction management~~ âœ… Done (PostgreSQL + Redis)
  - [x] ~~CORS configuration and API client setup~~ âœ… Done (localhost:5173 â†” localhost:3001)
  - [x] ~~File upload event handling and state management~~ âœ… Done (React state + async processing)
- [ ] **Script Analysis Display** ðŸŽ¯ NEXT: Implement Story 2.2
  - [ ] Show extracted text with formatting
  - [ ] Display identified characters list
  - [ ] Show detected scenes with character participation
  - [ ] User confirmation and editing capabilities

### Phase C: Character & Voice Setup (Day 2-3) ðŸ”„ UI READY
- [x] ~~**Character Selection Interface**~~ âœ… UI AVAILABLE
  - [x] ~~List all detected characters with descriptions~~ âœ… Done (from Lovable PoC)
  - [x] ~~User selects their character role~~ âœ… Done (character selection component)
  - [x] ~~Visual character card design~~ âœ… Done (modern UI with traits/personality)
- [ ] **AI Voice Generation Integration** ðŸŽ¯ NEXT: Implement Story 2.3
  - [ ] Connect to ElevenLabs API for voice synthesis
  - [ ] Generate unique voice for each AI character
  - [ ] Voice preview functionality
  - [ ] Voice consistency management

### Phase D: Scene Selection & Setup (Day 3) ðŸ“‹ PLANNED
- [ ] **Scene Browser Component** ðŸŽ¯ NEXT: Part of Story 2.2
  - [ ] List scenes with character participation
  - [ ] Scene context and description display
  - [ ] Character involvement indicators
- [ ] **Practice Session Setup** ðŸŽ¯ NEXT: Story 2.4
  - [ ] Scene selection and confirmation
  - [ ] User character preparation interface
  - [ ] Practice mode options (guided/free)

### Phase E: Interactive Scene Practice (Day 4) ðŸ“‹ PLANNED
- [ ] **Scene Playback Engine** ðŸŽ¯ NEXT: Story 2.4
  - [ ] Turn-based conversation management
  - [ ] AI voice audio playback system
  - [ ] User input handling (text/voice)
  - [ ] Scene progression logic
- [x] ~~**Practice Session UI**~~ âœ… UI READY
  - [x] ~~Clean, focused practice interface~~ âœ… Done (from Lovable PoC)
  - [x] ~~Character line display and prompts~~ âœ… Done (script text display)
  - [ ] Audio controls and timing ðŸŽ¯ NEXT: Story 2.4
  - [ ] Session navigation controls ðŸŽ¯ NEXT: Story 2.4

### Phase F: Session Management & Polish (Day 5) ðŸ“‹ PLANNED
- [ ] **Session Controls** ðŸŽ¯ NEXT: Story 2.5
  - [ ] Pause, resume, restart functionality
  - [ ] Session progress tracking
  - [ ] Practice history storage
- [x] ~~**UI/UX Polish**~~ âœ… FOUNDATION READY
  - [x] ~~Responsive design across screen sizes~~ âœ… Done (mobile-first from Lovable)
  - [x] ~~Smooth animations and transitions~~ âœ… Done (modern CSS animations)
  - [x] ~~Error handling and user feedback~~ âœ… Done (toast notifications)
  - [x] ~~Performance optimization~~ âœ… Done (Vite + modern React patterns)

## Technical Implementation

### Frontend Architecture
```typescript
// Core Components Structure
apps/web-v2/src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ScriptUpload/         # File upload and analysis
â”‚   â”œâ”€â”€ CharacterSelect/      # Character choice interface
â”‚   â”œâ”€â”€ SceneSelect/          # Scene selection browser
â”‚   â”œâ”€â”€ VoicePreview/         # AI voice testing
â”‚   â”œâ”€â”€ PracticeSession/      # Main practice interface
â”‚   â””â”€â”€ SessionHistory/       # Practice tracking
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useScriptAnalysis     # Script processing logic
â”‚   â”œâ”€â”€ useVoiceGeneration    # AI voice management
â”‚   â””â”€â”€ usePracticeSession    # Session state management
â””â”€â”€ services/
    â”œâ”€â”€ apiClient.ts          # Backend integration
    â”œâ”€â”€ voiceService.ts       # ElevenLabs integration
    â””â”€â”€ audioPlayer.ts        # Audio playback management
```

### Backend Integration
- **Reuse Existing API**: `/scripts` endpoint for upload and analysis
- **New Endpoints Needed**:
  - `GET /scripts/:id/characters` - Character list with analysis
  - `GET /scripts/:id/scenes` - Scene breakdown with characters
  - `POST /voices/generate` - AI voice generation
  - `GET /scenes/:id/practice` - Practice session data

### Voice Integration
- **Primary**: ElevenLabs Flash v2.5 for character voices
- **Fallback**: Play.HT for redundancy and cost optimization
- **Languages**: Spanish and English support
- **Performance**: ~75ms latency target for natural conversation

## Success Criteria

### Technical Validation
- [ ] Complete script-to-practice workflow functional
- [ ] AI voice generation working for all character types
- [ ] Scene practice playable end-to-end
- [ ] Cross-browser compatibility (Chrome, Firefox, Safari, Edge)
- [ ] Responsive design working on desktop and tablet

### User Experience Validation
- [ ] Intuitive workflow from upload to practice
- [ ] Natural-feeling conversation with AI characters
- [ ] Clear visual feedback and progress indicators
- [ ] Error states handled gracefully
- [ ] Session can be completed without confusion

### Business Validation
- [ ] Core value proposition demonstrable to users
- [ ] Complete user journey testable
- [ ] Competitive differentiation visible (AI scene partners)
- [ ] Educational value clear from practice sessions
- [ ] User feedback collection possible

## Dev Notes

### Reusable Assets from Story 1.1
- **ScriptUpload Logic**: File handling, validation, progress UI
- **API Backend**: All existing endpoints work without changes
- **Database Schema**: Script and character models already designed
- **PDF Processing**: Text extraction and analysis pipeline

### New Development Areas
- **Character Detection**: Enhance AI analysis for character identification
- **Voice Synthesis**: New integration with ElevenLabs API
- **Scene Parsing**: Break scripts into practiceable scene segments
- **Conversation Engine**: Turn-based interaction with AI characters
- **Audio Playback**: Seamless voice audio integration

### Performance Considerations
- **Bundle Size**: Target <1MB for fast loading
- **API Calls**: Optimize for minimal voice generation requests
- **Audio Loading**: Preload character voices for smooth playback
- **Caching**: Cache generated voices and scene data

## Timeline
- **Architecture Complete**: 2025-09-26 âœ… DONE
- **Development Ready**: 2025-09-26 âœ… DONE
- **Next Phase**: Stories 2.2-2.5 (Character Detection â†’ Voice Synthesis â†’ Practice Sessions â†’ Feedback)
- **Target PoC Completion**: Based on individual story completion
- **User Testing**: After Story 2.4 completion (interactive sessions working)

## Related Documents
- `docs/architecture/decisions/adr-002-react-web-poc-pivot.md` - Architecture decision
- `docs/stories/1.1.basic-script-upload-and-text-processing.md` - Reusable components
- `docs/architecture/tech-stack.md` - Phase 1 technology stack

## Definition of Done
- [ ] Working web application deployed and accessible
- [ ] Complete user journey from script upload to scene practice functional
- [ ] AI voice generation integrated and working
- [ ] User can practice scenes with AI characters speaking
- [ ] Session management working (pause, resume, restart)
- [ ] Ready for user testing and feedback collection
- [ ] Documented for Flutter migration reference (Phase 2)

---

**Priority**: HIGHEST - This is the foundation for all future development and user validation